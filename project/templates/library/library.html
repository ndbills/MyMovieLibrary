{% extends "usernav.html" %}
{% block content %}
    <div class="col-sm-12">
        <div class="col-md-4">
            <h3>{{ library.name ~ ' ' ~ library.unit }} Library </h3>
        </div>
        <div class="btn-group pull-right">
            <button type="button" class="btn btn-default add-movie" data-toggle="modal" data-target="#addMovie-form">Add Movie</button>
        </div>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <td>Movie</td>
                    <td>Summary</td>
                    <td>Rating</td>
                    <td>Options</td>
                </tr>
            </thead>
            <tbody>
                {% if library.collection|length  <= 0 %}
                    <tr> 
                        <td>No Movies are in this collection </td>
                    </tr>
                {% else %}
                    {% for movie in library.hydrateList() %}
                        <tr class='clickable' data-id='{{ loop.index }}'>
                        <td>
                            <img src="{{ movie.poster|default('') }}" style="max-width: 200px;" alt="{{ movie.title }}">
                            <p>{{ movie.title }}</p>
                        </td>
                        <td>
                            {{ movie.summary }}
                        </td>
                        <td>
                            {{ movie.rating }}
                        </td>
                        <td>
                            <div class="btn-group-vertical">
                              <button type="button" class="btn btn-default btn-small lend-movie" data-id='{{ movie.id }}'>Lend</button>
                              <button type="button" class="btn btn-default btn-small borrow-movie" data-id='{{ movie.id }}'>Edit</button>
                              <button type="button" class="btn btn-default btn-small remove-movie" data-id='{{ movie.id }}'>Remove</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}

                {% endif %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block javascript %}
    <script>
        $(function(){
            var libraryPath = '{{ url_for("libraryItem", name=library.name, index="999") }}';
            $('.clickable').on('click',function(){
                var libname = $(this).data('id');
                window.document.location = libraryPath.replace('999',libname);
            })
        });
    </script>
{% endblock %}

{% block modals %}
    {% include 'library/addmovie_modal.html' %}
{% endblock %}